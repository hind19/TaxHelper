<Window x:Class="TaxHelper.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:i="http://schemas.microsoft.com/expression/interaction"
        xmlns:local="clr-namespace:TaxHelper"
        mc:Ignorable="d"
        Title="Налоговый калькулятор"
        Height="450"
        Width="800">
    <Window.DataContext>
        <local:MainWindowVM />
    </Window.DataContext>
    <Window.Resources>
        <Style x:Key="tblocktyle" TargetType="TextBlock">
            <Setter Property="Margin"
                    Value="5" />
            <Setter Property="Padding"
                    Value="5" />
            <Setter Property="FontSize"
                    Value="18" />
            <Setter Property="FontWeight"
                    Value="Bold" />
        </Style>
        <Style x:Key="btnStyle" TargetType="Button">
            <Setter Property="Margin"
                    Value="5" />
            <Setter Property="Padding"
                    Value="7,3" />
            <Setter Property="Width"
                    Value="200" />
            <Setter Property="BorderThickness"
                    Value="2" />
            <Setter Property="VerticalAlignment"
                    Value="Center" />
            <Setter Property="FontSize"
                    Value="16" />
            <Setter Property="FontWeight"
                    Value="Bold" />
        </Style>
        <Style x:Key="tblockGreen"
               TargetType="TextBlock"
               BasedOn="{StaticResource tblocktyle}">
            <Setter Property="Foreground"
                    Value="Green" />
        </Style>
        <Style x:Key="tblockRed"
               TargetType="TextBlock"
               BasedOn="{StaticResource tblocktyle}">
            <Setter Property="Foreground"
                    Value="DarkRed" />
        </Style>
    </Window.Resources>
    
    <Grid Background="LightGray">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <GroupBox Header="Источник данных"
                  Grid.Row="0"
                  Margin="10">
            <StackPanel Orientation="Horizontal">
                <RadioButton Content="Ручной ввод"
                             IsChecked="{Binding IsManualSource}"
                             Margin="15" />
                <RadioButton Content=".csv"
                             IsChecked="{Binding IsCsvSource}"
                             Margin="15" />
            </StackPanel>

        </GroupBox>
        <StackPanel Orientation="Vertical"
                    HorizontalAlignment="Stretch"
                    Grid.Row="1">
            <Button Name="btnAddActivity"
                    Style="{StaticResource ResourceKey=btnStyle}"
                    Content="Добавить платеж"
                    Command="{Binding AddPaymentCommand}"
                    />
            <ListView ItemsSource="{Binding Payments}"
                      Background="LightGray"
                      MaxHeight="600"
                      ScrollViewer.VerticalScrollBarVisibility="Auto"
                      ScrollViewer.CanContentScroll="True">
                <ListView.ItemTemplate>
                    <DataTemplate>
                        <Grid HorizontalAlignment="Left">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="0.2*" />
                                <ColumnDefinition Width="0.7*" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <DatePicker x:Name="datePicker"
                                        Grid.Column="0"
                                        SelectedDate="{Binding PaymentDate}"
                                        Margin="20" />
                            <TextBox x:Name="Sum"
                                     Grid.Column="1"
                                     Width="50"
                                     Text="{Binding PaymentSum}"
                                     HorizontalAlignment="Center"
                                     VerticalAlignment="Center"
                                     Margin="20" />
                            <ComboBox Grid.Column="2"
                                      ItemsSource="{Binding DataContext.CurrenciesList, RelativeSource={RelativeSource AncestorType={x:Type Window}, Mode=FindAncestor}}"
                                      SelectedValue="{Binding PaymentCurrency}"
                                      Width="200"
                                      HorizontalAlignment="Center"
                                      VerticalAlignment="Center"
                                      Margin="20" />
                            <Button x:Name="btnDeletePayment"
                                    Grid.Column="3"
                                    Content="X"
                                    Foreground="Red"
                                    FontWeight="Bold"
                                    Command="{Binding DataContext.RemovePaymentCommand, RelativeSource={RelativeSource AncestorType={x:Type Window}, Mode=FindAncestor}}"
                                    CommandParameter="{Binding}"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Margin="20"
                                    Padding="5,0" />
                        </Grid>
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>
        </StackPanel>
        <Grid Grid.Row="2">
            <Grid.RowDefinitions>
                <RowDefinition Height="0.33*" />
                <RowDefinition Height="0.33*" />
                <RowDefinition Height="0.33*" />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="0.3*" />
                <ColumnDefinition Width="0.7*" />
            </Grid.ColumnDefinitions>
            <Button Name="btnCalculateTax"
                    Content="Рассчитать налог"
                    Grid.Row="0"
                    Grid.RowSpan="3"
                    Command="{Binding CalculateTaxCommand}"
                    Style="{StaticResource ResourceKey=btnStyle}"/>
            <StackPanel Grid.Row="0"
                        Grid.Column="1"
                        Orientation="Horizontal"
                        HorizontalAlignment="Stretch"
                        VerticalAlignment="Center">
                <TextBlock Style="{StaticResource ResourceKey=tblockGreen}"
                           Text="Общий доход в нац валюте:" />
                <TextBlock Style="{StaticResource ResourceKey=tblockGreen}"
                           Text="{Binding TaxesResult.TotalSumUah}"
                           Margin="5" />
            </StackPanel>
            <StackPanel Orientation="Horizontal"
                        Grid.Row="1"
                        Grid.Column="1"
                        HorizontalAlignment="Stretch"
                        VerticalAlignment="Center">
                <TextBlock Style="{StaticResource ResourceKey=tblockRed}"
                        Text="Единый налог:" />
                <TextBlock  Style="{StaticResource ResourceKey=tblockRed}"
                            Text="{Binding TaxesResult.UnitedTax}"/>
            </StackPanel>
            <StackPanel Orientation="Horizontal"
                    Grid.Row="2"
                        Grid.Column="1"
                        HorizontalAlignment="Stretch"
                        VerticalAlignment="Center">
                <TextBlock Style="{StaticResource ResourceKey=tblockRed}"
                           Text="Военный налог:" />
                <TextBlock Style="{StaticResource ResourceKey=tblockRed}"
                           Text="{Binding TaxesResult.MilitaryTax}"
                           Margin="5" />
            </StackPanel>
        </Grid>
    </Grid>
</Window>
